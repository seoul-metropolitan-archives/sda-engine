<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="rmsoft.ams.seoul.cl.cl002.dao.Cl002Mapper">
    <select id="getClassificationScheme" resultType="Cl00101VO" statementType="PREPARED">
        <![CDATA[
            SELECT
              CLASSIFICATION_CODE as classificationCode,
              CLASSIFICATION_NAME as classificationName,
              CLASSIFICATION_SCHEME_UUID as classificationSchemeUuid
            FROM
              CL_CLASSIFICATION_SCHEME
            WHERE
              ROWNUM <= 1
            ORDER BY
              CLASSIFICATION_CODE ASC
        ]]>
    </select>
    <select id="getClassList" resultType="Cl00201VO" parameterType="Cl00201VO" statementType="PREPARED">
        SELECT
          CLASS_UUID as classUuid,
          CLASSIFICATION_SCHEME_UUID as classificationSchemeUuid,
          STATUS_UUID as statusUuid,
          PARENT_CLASS_UUID as parentClassUuid,
          CLASS_CODE as classCode,
          CLASS_NAME as className,
          CLASS_LEVEL_UUID as classLevelUuid,
          ORDER_NO as orderNo,
          ORDER_KEY as orderKey,
          USE_YN as useYn,
        <include refid="Common.UserName"><property name="userUuid" value="INSERT_UUID"/></include> as insertUuid,
          INSERT_DATE as insertDate,
        <include refid="Common.UserName"><property name="userUuid" value="UPDATE_UUID"/></include> as updateUuid,
          UPDATE_DATE as updateDate
        FROM
          CL_CLASS
        <where>
            <if test="classificationSchemeUuid != null">
                CLASSIFICATION_SCHEME_UUID = #{classificationSchemeUuid}
            </if>
            <if test="parentClassUuid != null">
                AND  PARENT_CLASS_UUID = #{parentClassUuid}
            </if>
            <if test="statusUuid != null">
                AND STATUS_UUID = #{statusUuid}
            </if>
            <if test="classCode != null">
                AND CLASS_CODE = #{classCode}
            </if>
            <if test="className != null">
                AND CLASS_NAME = #{className}
            </if>
            <if test="classLevelUuid != null">
                AND CLASS_LEVEL_UUID = #{classLevelUuid}
            </if>
            <if test="useYn != null">
                AND USE_YN = #{useYn}
            </if>
        </where>
    </select>
    <select id="getClassHierarchyList" resultType="cl00201VO" parameterType="cl00201VO" statementType="PREPARED">
        SELECT
          CLASS_UUID as classUuid,
          CLASSIFICATION_SCHEME_UUID as classificationSchemeUuid,
          STATUS_UUID as statusUuid,
          PARENT_CLASS_UUID as parentClassUuid,
          CLASS_CODE as classCode,
          CLASS_NAME as className,
          CLASS_LEVEL_UUID as classLevelUuid,
          ORDER_NO as orderNo,
          REPLACE(ORDER_KEY,'-','.' )as orderKey,
          USE_YN as useYn,
          <include refid="Common.UserName"><property name="userUuid" value="INSERT_UUID"/></include> as insertUuid,
          INSERT_DATE as insertDate,
          <include refid="Common.UserName"><property name="userUuid" value="UPDATE_UUID"/></include> as updateUuid,
          UPDATE_DATE as updateDate
        FROM
          CL_CLASS
        <where>
            <if test="classificationSchemeUuid != null">
                CLASSIFICATION_SCHEME_UUID = #{classificationSchemeUuid}
            </if>
        </where>
        START WITH PARENT_CLASS_UUID IS NULL
        CONNECT BY PRIOR CLASS_UUID = PARENT_CLASS_UUID
        ORDER SIBLINGS BY ORDER_NO
    </select>
</mapper>